let instantload,InstantLoad=instantload=function(){let e=false,t=[],r=null;const o=[],n={preload:[],postload:[],change:[],init:[]},l={};triggerEvent=(e=>{for(let t=0;t<n[e].length;t++){n[e][t]()}}),registerEvent=((e,t)=>{n[e].push(t)}),updateScripts=(()=>{let e=[];document.head.querySelectorAll("script").forEach(t=>{if(!t.hasAttribute("instantload-blacklist"))e.push(t)});document.body.querySelectorAll("script").forEach(t=>{if(!t.hasAttribute("instantload-blacklist"))e.push(t)});for(let t=0;t<e.length;t++){if(e[t].instantload_tracked!=true)continue;let r=document.createElement("script"),o=e[t],n=o.parentNode,l=o.nextSiblings;r.textContent=o.textContent;r.instantload_tracked=true;for(let e=0;e<o.attributes.length;e++){r.setAttribute(o.attributes[e].name,o.attributes[e].value)}o.remove();n.insertBefore(r,l)}}),clearURL=(e=>{return e.split("#").join("")}),changePage=((e,t)=>{l[clearURL(location.href)].scrollPos={x:window.scrollX,y:window.scrollY};r.abort();clearTrackedElements();document.documentElement.replaceChild(e.body,document.body);document.documentElement.replaceChild(e.head,document.head);updateScripts();if(t!=null){history.pushState(null,null,t);scrollTo(0,0);l[clearURL(location.href)]={document:{head:document.head,body:document.body},scrollPos:{x:window.scrollX,y:window.scrollY}}}trackPreloadableElements();triggerEvent("change")}),preloadPage=((e,t,o)=>{triggerEvent("preload");r=new XMLHttpRequest;r.open("get",e);r.timeout=9e4;r.send();r.onload=(()=>{let e=document.implementation.createHTMLDocument("");e.documentElement.innerHTML=r.responseText;t.preloadedPage=e;triggerEvent("postload");o()})}),popstateEvent=(e=>{if(l[clearURL(location.href)]==null){location.reload()}else{changePage(l[clearURL(location.href)].document);scrollTo(l[clearURL(location.href)].scrollPos.x,l[clearURL(location.href)].scrollPos.y)}}),mouseOverEvent=(e=>{if(e.target.isPreloaded)return;preloadPage(clearURL(e.target.href),e.target,()=>{e.target.isPreloaded=true})}),mouseClickEvent=(e=>{e.preventDefault();if(e.target.isPreloaded){e.target.isPreloaded=false;changePage(e.target.preloadedPage,e.target.href)}else{preloadPage(clearURL(e.target.href),e.target,()=>{e.target.isPreloaded=true;changePage(e.target.preloadedPage,e.target.href)})}}),isNoPreload=(e=>{if(e.hasAttribute("instantload-blacklist"))return true;return false}),isPreloadable=(e=>{const t=location.protocol+"//"+location.host+"/";if(e.taget||e.href.indexOf(t)!=0||isNoPreload(e))return false;return true}),addEventListeners=(()=>{for(let e=0;e<t.length;e++){t[e].addEventListener("mouseover",mouseOverEvent);t[e].addEventListener("click",mouseClickEvent)}window.addEventListener("popstate",popstateEvent)}),trackPreloadableElements=(()=>{document.querySelectorAll("a").forEach(function(e){if(isPreloadable(e)){t.push(e)}});addEventListeners()}),removeEventListeners=(()=>{for(let e=0;e<t.length;e++){t[e].removeEventListener("mouseover",mouseOverEvent);t[e].removeEventListener("click",mouseClickEvent)}}),clearTrackedElements=(()=>{removeEventListeners();t=[]}),isSupported=(()=>{if(!"pushState"in history)return false;if(location.protocol=="file:")return false;return true}),isRunning=(()=>{return e}),init=(()=>{if(e){console.warn("InstantLoad is already initialized.");return}e=true;if(!isSupported()){console.error("InstantLoad is not supported in this browser or protocol!");return}trackPreloadableElements();l[clearURL(location.href)]={document:{head:document.head,body:document.body},scrollPos:{x:window.scrollX,y:window.scrollY}};triggerEvent("init")});return{init:init,on:registerEvent,isRunning:isRunning,history:l}}();